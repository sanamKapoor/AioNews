{"version":3,"sources":["components/img/user-icon.png","components/Login.js"],"names":["module","exports","Login","props","useForm","mode","register","handleSubmit","errors","watch","reset","useState","isLogin","setLogin","err","setError","history","useHistory","sameEmail","user","values","email","password","localStorage","setItem","JSON","stringify","push","setTimeout","diffEmail","useEffect","confirmPassword","clearError","onSubmit","users","parse","getItem","savedNews","createUser","Users","newUser","className","src","avatar","alt","type","name","ref","required","pattern","value","message","placeholder","minLength","validate","onClick"],"mappings":"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","file":"static/js/5.2827d5ee.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/user-icon.54e9ec53.png\";","import React, { useState, useEffect } from 'react';\r\nimport { useForm } from 'react-hook-form';\r\nimport { useHistory } from 'react-router-dom';\r\nimport avatar from \"./img/user-icon.png\";\r\n\r\nfunction Login(props) {\r\n\r\n    const { register, handleSubmit, errors, watch, reset } = useForm({ mode: 'onChange'});\r\n    const [isLogin, setLogin] = useState(false);\r\n    const [err, setError] = useState(false);\r\n    let userCreated  = true;\r\n\r\n    let history = useHistory(); \r\n  \r\n    const sameEmail = (user, values) => {\r\n  \r\n      if(isLogin){\r\n        \r\n        if(user.email === values.email && user.password === values.password){\r\n          localStorage.setItem('user', JSON.stringify(user))\r\n          history.push('/home');\r\n          reset();\r\n          return;\r\n        } \r\n        else {\r\n          setError('Please enter correct email and password');\r\n  \r\n          setTimeout(() => {\r\n            setError('')\r\n          }, 2000)\r\n  \r\n          reset();\r\n          return;\r\n        }\r\n      } \r\n      else {\r\n        setError('User with this email already exist');\r\n  \r\n        setTimeout(() => {\r\n          setError('')\r\n        }, 2000)\r\n  \r\n        reset();\r\n        }\r\n    } \r\n  \r\n    const diffEmail = (user, values) => {\r\n      if(isLogin){\r\n        setError('User with this email does not exist');\r\n  \r\n          setTimeout(() => {\r\n            setError('')\r\n          }, 2000)\r\n  \r\n          reset();\r\n          return;\r\n      } \r\n    }\r\n  \r\n    const newUser = (values) => {\r\n      if(!isLogin){\r\n  \r\n        let user = {\r\n          email: values.email,\r\n          password: values.password,\r\n          savedNews: []\r\n        }\r\n  \r\n        let Users = [];\r\n        Users.push(user);\r\n        localStorage.setItem('users', JSON.stringify(Users));\r\n        \r\n        reset();\r\n        localStorage.setItem('user', JSON.stringify(user))\r\n        history.push('/home');\r\n        return;\r\n      } else {\r\n        setError('You need to register first');\r\n  \r\n        setTimeout(() => {\r\n          setError('')\r\n        }, 2000)\r\n  \r\n        reset();\r\n        return;\r\n      }\r\n    }\r\n  \r\n    const createUser = (values) => {\r\n      if(!isLogin){\r\n  \r\n      let user = {\r\n        email: values.email,\r\n        password: values.password,\r\n        savedNews: []\r\n      }\r\n  \r\n      let users = JSON.parse(localStorage.getItem('users'));\r\n      users.push(user);\r\n      localStorage.setItem('users', JSON.stringify(users));\r\n      localStorage.setItem('user', JSON.stringify(user))\r\n      history.push('/home');\r\n  \r\n      reset();\r\n      return;\r\n      }\r\n    }\r\n   \r\n    const Submit = values => {\r\n  \r\n      let users = JSON.parse(localStorage.getItem('users'));\r\n  \r\n      if(users){\r\n        for(let user of users){\r\n          if(user.email === values.email){\r\n            sameEmail(user, values);\r\n            return;\r\n          } else {\r\n            diffEmail(user, values);\r\n          }\r\n        }\r\n      } else {\r\n        newUser(values);\r\n        return;\r\n      }\r\n  \r\n      if(userCreated){\r\n        createUser(values);\r\n      } \r\n    }\r\n  \r\n    const clearError = (errors) => {\r\n      setTimeout(() => {\r\n        errors.email = null\r\n        errors.password = null\r\n        errors.confirmPassword = null\r\n      }, 1000)\r\n    }\r\n  \r\n    useEffect(() => {\r\n      clearError(errors)\r\n    }, [errors])\r\n  \r\n    return (\r\n        <article>\r\n        <form onSubmit={handleSubmit(Submit)} className=\"form p-4 p-lg-5 text-primary shadow\">\r\n            <div className=\"text-center\">\r\n            <img src={avatar} className=\"user-img\" alt=\"\"/>\r\n            </div>\r\n          <input \r\n              type=\"email\" \r\n              name=\"email\"\r\n              ref={\r\n                register({\r\n                  required: 'Email is required',\r\n                  pattern: {\r\n                    value: /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$/,\r\n                    message: 'Invalid email address'\r\n                  }\r\n                })\r\n              }\r\n              placeholder=\"Enter Email\" \r\n              className=\"form-text mt-4 form-control shadow-sm border-0 rounded-pill px-3\" />\r\n              {\r\n                errors.email && <small className=\"text-danger mx-3\">{errors.email.message}</small>\r\n              }\r\n\r\n            <input \r\n              type=\"password\" \r\n              name=\"password\" \r\n              ref={\r\n                register({\r\n                  required: 'Password is required',\r\n                  minLength: {\r\n                    value: 6,\r\n                    message: 'Password should be 6 characters long'\r\n                  }\r\n                })\r\n              }\r\n              placeholder=\"Enter Password\" \r\n              className=\"form-text mt-3 form-control shadow-sm border-0 rounded-pill px-3\" />\r\n              {\r\n                errors.password && <small className=\"text-danger mx-3\">{errors.password.message}</small>\r\n              }          \r\n              \r\n              {\r\n              !isLogin ?\r\n                <input \r\n                type=\"password\" \r\n                name=\"confirmPassword\" \r\n                ref={\r\n                  register({\r\n                    required: 'Confirm your password',\r\n                    validate: (value) => value === watch('password') || \"Password don't match\"\r\n                  })\r\n                }\r\n                placeholder=\"Confirm Password\" \r\n                className=\"form-text mt-3 form-control shadow-sm border-0 rounded-pill px-3\" />              \r\n                : ''\r\n             }\r\n            { \r\n            (!isLogin && errors.confirmPassword) && <small className=\"text-danger mx-3\">{errors.confirmPassword.message}</small>\r\n            }\r\n\r\n          <div className=\"my-3 text-center\">\r\n            { err && <small className=\"text-danger mb-1\">{err}</small>}\r\n            <button type=\"submit\" className=\"form-text btn btn-primary btn-block shadow rounded-pill\">\r\n            { isLogin ? 'Login' : 'Sign Up'}\r\n            </button>\r\n          </div>\r\n          <div className=\"text-center\">\r\n            <span onClick={() => setLogin(!isLogin)} className=\"form-text text-dark switch-btn\">\r\n            { !isLogin ? 'Login' : 'Register'}\r\n            </span>\r\n          </div>\r\n        </form>\r\n        </article>\r\n    )\r\n}\r\n\r\nexport default Login\r\n"],"sourceRoot":""}